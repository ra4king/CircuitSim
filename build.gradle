plugins {
	id 'java'
}

def getVersionName = { ->
	def stdout = new ByteArrayOutputStream()
	exec {
		commandLine 'git', 'describe', '--abbrev=0'
		standardOutput = stdout
	}
	return stdout.toString().trim()
}

description = 'CircuitSimulator - Basic Circuit Simulator'
version = getVersionName()

sourceSets {
	main {
		java {
			srcDirs = ['src/com']
		}
		resources {
			srcDirs = ['src/resources']
		}
		output.resourcesDir = "build/classes/main/resources"
	}
}

String out = project.buildDir.getPath() + java.io.File.separatorChar + "libs" + java.io.File.separatorChar + "CircuitSimulator-" + getVersionName() + ".jar"

task run(dependsOn: jar, type: JavaExec) {
	main = "-jar"
	args = [
	        	out
           ]
}

repositories {
	mavenCentral()
}

dependencies {
	implementation group: 'com.google.code.gson', name: 'gson', version: '2.8.+'
}

jar {
	manifest {
		attributes("Manifest-Version" : "1.0",
		           "Main-Class" : "com.ra4king.circuitsimulator.gui.CircuitSimulator")
	}
}
